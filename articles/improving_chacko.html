<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Improving the Chacko (1966) test • permChacko</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Improving the Chacko (1966) test">
<meta property="og:description" content="permChacko">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">permChacko</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/improving_chacko.html">Improving the Chacko (1966) test</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ocbe-uio/permChacko/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Improving the Chacko (1966) test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ocbe-uio/permChacko/blob/HEAD/vignettes/improving_chacko.Rmd" class="external-link"><code>vignettes/improving_chacko.Rmd</code></a></small>
      <div class="hidden name"><code>improving_chacko.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="chackos-ordering-process">Chacko’s ordering process<a class="anchor" aria-label="anchor" href="#chackos-ordering-process"></a>
</h2>
<p>We begin with a list of <span class="math inline">\(k\)</span> values
<span class="math inline">\(\{x_1, \ldots, x_k\}\)</span> with
associated weights <span class="math inline">\(t_1 = \ldots = t_k =
1\)</span>.</p>
<p>If for any <span class="math inline">\(1 \leq i \leq (k - 1)\)</span>
we have that <span class="math inline">\(x_k &gt; x_{k + 1}\)</span>,
then we replace both values <span class="math inline">\(x_k\)</span> and
<span class="math inline">\(x_{k + 1}\)</span> by a single value which
is their weighted average (using the weights <span class="math inline">\(t_k\)</span> and <span class="math inline">\(t_{k
+ 1})\)</span>. This new value takes the combined weight of the two
values it replaces, <span class="math inline">\(t_k + t_{k +
1}\)</span>. The list is now one shorter, so <span class="math inline">\(k\)</span> becomes <span class="math inline">\(k -
1\)</span>.</p>
<p>We repeat this process until either <span class="math inline">\(k =
1\)</span> or we have a monotone increasing sequence of numbers.</p>
<p>We can recreate the two ordering process examples shown on pages 187
(section 3) and 189 (section 5) of Chacko (1966) in this package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ocbe-uio.github.io/permChacko/" class="external-link">permChacko</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is permChacko 0.2.0</span></span>
<span><span class="co">## To learn more about the package, please read the documentation available in the commands below:</span></span>
<span><span class="co">## help("permChacko-package")</span></span>
<span><span class="co">## browseVignettes("permChacko")</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reduceVector.html">reduceVector</a></span><span class="op">(</span><span class="va">chacko66_sec3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Original vector: 10  16  14  12  18</span></span>
<span><span class="co">## Reduced vector : 10  14  18</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reduceVector.html">reduceVector</a></span><span class="op">(</span><span class="va">chacko66_sec5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Original vector: 12  14  18  16  22  20  18  24  26  30</span></span>
<span><span class="co">## Reduced vector : 12  14  17  20  24  26  30</span></span></code></pre>
<p>Notice that Chacko was entirely comfortable with this ordering
process ending with a single value. If you look at their table on page
188 then he suggests that under the null hypothesis, if you start with a
list of 5 values, then you have a 20% chance that the order process
results in a single value.</p>
<p>The aforementioned table is available both in Chacko (1963) and
Chacko (1966), as well as in this package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chacko63_tab1</span></span></code></pre></div>
<pre><code><span><span class="co">##           k = 3    k = 4    k = 5    k = 6    k = 7    k = 8    k = 9   k = 10</span></span>
<span><span class="co">## m = 1  0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000</span></span>
<span><span class="co">## m = 2  0.500000 0.458333 0.416667 0.380556 0.350000 0.324107 0.301984 0.282897</span></span>
<span><span class="co">## m = 3  0.166667 0.250000 0.291667 0.312500 0.322222 0.325694 0.325519 0.323165</span></span>
<span><span class="co">## m = 4        NA 0.041667 0.083333 0.118055 0.145833 0.167882 0.185417 0.199427</span></span>
<span><span class="co">## m = 5        NA       NA 0.008333 0.020833 0.034722 0.048611 0.061863 0.074219</span></span>
<span><span class="co">## m = 6        NA       NA       NA 0.001389 0.004167 0.007986 0.012500 0.017436</span></span>
<span><span class="co">## m = 7        NA       NA       NA       NA 0.000198 0.000694 0.001505 0.002604</span></span>
<span><span class="co">## m = 8        NA       NA       NA       NA       NA 0.000025 0.000099 0.000240</span></span>
<span><span class="co">## m = 9        NA       NA       NA       NA       NA       NA 0.000003 0.000012</span></span>
<span><span class="co">## m = 10       NA       NA       NA       NA       NA       NA       NA 0.000000</span></span></code></pre>
<p>Even if the outcome is a single value, the test statistic can be
calculated from equation 5 on page 188, i.e.:</p>
<p><span class="math display">\[
\bar\chi^2 = \frac{k}{n} \sum_{j = 1}^m t_j \left[ \bar x_{t_j} -
\frac{n}{k}\right]^2
\]</span></p>
<p>In the equation above, <span class="math inline">\(\bar
x_{t_j}\)</span> are the values in the reduced vector, <span class="math inline">\(n = \sum_{i = 1}^k x_i\)</span>, <span class="math inline">\(m\)</span> is the number of elements in the final
reduced vector <span class="math inline">\(\bar x\)</span>. The
statistic <span class="math inline">\(\bar\chi^2\)</span> is
asymptotically distributed as <span class="math inline">\(\chi^2(m -
1)\)</span>.</p>
<p>The question then becomes how to obtain a <span class="math inline">\(p\)</span>-value associated with this test
statistic.</p>
</div>
<div class="section level2">
<h2 id="calculating-p-values">Calculating <span class="math inline">\(p\)</span>-values<a class="anchor" aria-label="anchor" href="#calculating-p-values"></a>
</h2>
<p>Given that <span class="math inline">\(\bar\chi^2 \sim \chi^2(m -
1)\)</span>, an analytical <span class="math inline">\(p\)</span>-value
can be calculated for the test statistic for any <span class="math inline">\(m &gt; 1\)</span>. Moreover, for certain
combinations of <span class="math inline">\(m\)</span> and <span class="math inline">\(k\)</span> the <span class="math inline">\(p\)</span>-value can be calculated using the table
shown below. Finally, a numeric <span class="math inline">\(p\)</span>-value can be calculated through
computer simulation, which will be explained later. All these p-values
are calculated using the <code><a href="../reference/permChacko.html">permChacko()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/permChacko.html">permChacko</a></span><span class="op">(</span><span class="va">chacko66_sec3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##         Chacko Test for Order-restriction with Permutation Test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null hypothesis           : p1 == p2 == p3 == p4 == p5</span></span>
<span><span class="co">## Alternative hypothesis    : p1 &lt;= p2 &lt;= p3 &lt;= p4 &lt;= p5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test statistic (chisq_bar): 2.285714</span></span>
<span><span class="co">## p-values:</span></span>
<span><span class="co">##   Analytic p-value        : 0.318907</span></span>
<span><span class="co">##   Numeric p-value         : 0.164000 (1000 permutations)</span></span>
<span><span class="co">##   Tabular p-value         : 0.196052</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/permChacko.html">permChacko</a></span><span class="op">(</span><span class="va">chacko66_sec5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##         Chacko Test for Order-restriction with Permutation Test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Null hypothesis           : p1 == p2 == p3 == p4 == p5 == p6 == p7 == p8 == p9 == p10</span></span>
<span><span class="co">## Alternative hypothesis    : p1 &lt;= p2 &lt;= p3 &lt;= p4 &lt;= p5 &lt;= p6 &lt;= p7 &lt;= p8 &lt;= p9 &lt;= p10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test statistic (chisq_bar): 13.500000</span></span>
<span><span class="co">## p-values:</span></span>
<span><span class="co">##   Analytic p-value        : 0.035748</span></span>
<span><span class="co">##   Numeric p-value         : 0.005000 (1000 permutations)</span></span>
<span><span class="co">##   Tabular p-value         : 0.002294</span></span></code></pre>
<p>One omission from Chacko (1966) is the event where <span class="math inline">\(m = 1\)</span>. As discussed above, they clearly
expect that this will happen sometimes, but provide no explanation as to
how to calculate the <span class="math inline">\(p\)</span>-value in
this case. In this package, we suggest an approach to calculate this
value using a permutation test.</p>
<p>If you look at Chacko’s final example on how they evaluate
significance, they say that you reject the null hypothesis if the
observed calculated value obtained from the equation for <span class="math inline">\(\bar\chi^2\)</span> above is greater than the
value <span class="math inline">\(c\)</span> obtained from equation (6)
in the paper (reproduced below).</p>
<p><span class="math display">\[
\alpha = \sum_{m = 2}^k p_{m, k} \cdot p\left[\chi^2_{(m - 1)} \geq
c\right]
\]</span></p>
<p>This approach <em>does</em> work when <span class="math inline">\(m =
1\)</span>, but seems very cumbersome, requiring calculation of the
probability values <span class="math inline">\(p_{m, k}\)</span>, which
in turn requires consultation or partial recreation of the Chacko table.
With the computing power available to us, 60 years into the future from
Chacko’s seminal work, we can simply obtain a close-enough <span class="math inline">\(p\)</span>-value using a permutation test.</p>
<div class="section level3">
<h3 id="permutation-test">Permutation test<a class="anchor" aria-label="anchor" href="#permutation-test"></a>
</h3>
<p>Imagine that the sum of our original <span class="math inline">\(k\)</span> values is <span class="math inline">\(n\)</span>. Let a permutation be a stochastic
distribution of <span class="math inline">\(n\)</span> objects
(independently) across the <span class="math inline">\(k\)</span>
categories (with each one being equally likely under the null
hypothesis). For each such permutation we can go through Chacko’s
ordering procedure and calculate the test statistic according to
equation 5.</p>
<p>The <span class="math inline">\(p\)</span>-value in this case is
simply the fraction of such permutations that yield a test statistic
equal to or greater than the one we originally observed.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Waldir Leoncio, Graeme Ruxton, Morten Wang Fagerland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
